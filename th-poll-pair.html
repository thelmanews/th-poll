<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-ajax/core-ajax.html">
<link rel="import" href="../th-firebase/th-firebase.html">

<!--

@group Thelma Charts
@element th-poll-pair
@blurb Pairs th-poll-choices with a corresponding charting component to chart the results stored in Firebase.
@status alpha
@homepage http://github.com/thelmanews/thelma-charts/blob/master/th-poll-pair.html
-->

<polymer-element name="th-poll-pair" extends="th-animated" attributes="firebaseKey data">
  <template>
    <core-style ref="theme"></core-style>
    <style>
      :host {
        display: inline-block;
        position: relative;
        width: 200px;
        height: 250px;
      }

      

    </style>
     <th-firebase id="firebase" directory="polls/" location="https://shining-fire-6376.firebaseio.com/"></th-firebase>
  </template>
  <script>
        Polymer('th-poll-pair', {
          // pairingKey: "testing",
          // firebaseKey: "",
          _firebaseLocation: "",
          ready: function(){
            var self = this;
            self.firebase = self.$.firebase;

            // Set up listeners for data events from firebase
            self.firebase.addEventListener('th-data-ready', function(response) {
              // Data found in firebase, so load into component
              console.log("data received, now loading");
              self.data = response.detail;
              console.log(self.data);
            });

            self.firebase.addEventListener('th-data-error', function(response) {
              // No data in firebase for that URL, so call parse
              console.log(response.detail);
              self.data = {};
              // console.log(self.data);
            });
          },
          animate: function(){

          },
          reset: function(){

          },
          firebaseKeyChanged: function(){
            this.requestData();
          },
          requestData: function(){
            var self = this;
              self.$.firebase.load(self.firebaseKey); 
            }
        });

  </script>
</polymer-element>
